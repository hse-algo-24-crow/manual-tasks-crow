# Задание №11
# Задача о рюкзаке (Knapsack problem). Метод ветвей и границ
# Вариант 3
## Постановка задачи
Задача о рюкзаке (англ. Knapsack problem) — дано N предметов, n<sub>i</sub> предмет имеет массу w<sub>i</sub> > 0 и стоимость p<sub>i</sub> > 0. Необходимо выбрать из этих предметов такой набор, чтобы суммарная масса не превосходила заданной величины W (вместимость рюкзака), а суммарная стоимость была максимальна. 
| Предметы  | A  | B  | C  | D  | E |
|:----------|:--:|:--:|:--:|:--:|:-:|
| Стоимость | 11 | 5  | 3  | 12 | 8 |
| Вес       | 11 | 10 | 12 | 4  | 4 |

Ограничение вместимости: 22

## Решение
### 1. Рассчитаем ценность каждого предмета

| Предметы  | A  | B  | C  | D  | E |
|:----------|:--:|:--:|:--:|:--:|:-:|
| Стоимость | 11 | 5  | 3  | 12 | 8 |
| Вес       | 11 | 10 | 12 | 4  | 4 |
| Ценность  | 1  | 1/2| 1/4| 3  | 2 |
### 2. Отсортируем предметы по убыванию ценности
| Предметы  | D  | E  | A  | B  | C  |
|:----------|:--:|:--:|:--:|:--:|:--:|
| Стоимость | 12 | 8  | 11 | 5  | 3  |
| Вес       | 4  | 4  | 11 | 10 | 12 |
| Ценность  | 3  | 2  | 1  | 1/2| 1/4|
### 3. Рассчитаем оценку сверху для пустого рюкзака
Свободное место в рюкзаке: 22
Наибольшая ценность предмета: 3
Оценка сверху для пустого рюкзака: 21 * 3 = 66

### 4. Найдем решение задачи с использованием метода ветвей и границ





```mermaid
graph TB
    %% Корень. Рассматриваем D
    1(#1 22*3=66) --> |+D|2(#2 12 + 18*2=48)
    1 --> |-D|3(#3 22*2=44)

    %% Узел #2 (D взят) -> E
    2 --> |+E|4(#4 20 + 14*1=34)
    2 --> |-E|5(#5 12 + 18*1=30)

    %% Узел #3 (D не взят) -> E
    3 --> |+E|6(#6 8 + 18*1=26)
    3 --> |-E|7(#7 0 + 22*1=22)

    %% Узел #6 (D=0,E=1) -> A
    6 --> |+A|8(#8 19 + 7*0.5=22.5)
    6 --> |-A|9(#9 8 + 18*0.5=17)

    %% Узел #4 (D=1,E=1) -> A
    4 --> |+A|10(#10 31 + 3*0.5=32.5)
    4 --> |-A|11(#11 20 + 14*0.5=27)

    %% -- Достраиваем ветви для B и C --

    %% Узел #5 (D=1,E=0) -> A
    5 --> |+A|12(#12 23 + 7*0.5=26.5)
    5 --> |-A|13(#13 12 + 18*0.5=21)

    %% Узел #12 (D=1,E=0,A=1): B вес=10 не помещается (cap=7), C тоже => лист

    %% Узел #13 (D=1,E=0,A=0) -> B
    13 --> |+B|14(#14 17 + 8*0.25=19)
    13 --> |-B|15(#15 12 + 18*0.25=16.5)

    %% Узел #14 (D=1,E=0,A=0,B=1): C (вес=12) не помещается (cap=8) => лист

    %% Узел #15 (D=1,E=0,A=0,B=0) -> C
    15 --> |+C|16(#16 15)
    15 --> |-C|17(#17 12)

    %% Узел #16: (D=1,E=0,A=0,B=0,C=1), остаток 6 => лист
    %% Узел #17: (D=1,E=0,A=0,B=0,C=0), остаток 18 => лист

    %% Узел #7 (D=0,E=0) -> A
    7 --> |+A|18(#18 11 + 11*0.5=16.5)
    7 --> |-A|19(#19 0 + 22*0.5=11)

    %% Узел #18 (A=1) -> B
    18 --> |+B|20(#20 16 + 1*0.25=16.25)
    18 --> |-B|21(#21 11 + 11*0.25=13.75)
    %% #20: B взят (cost=16, cap=1), C не помещается => лист
    %% #21: B не взят (cost=11, cap=11), C вес=12 не помещается => лист

    %% Узел #19 (A=0) -> B
    19 --> |+B|22(#22 5 + 12*0.25=8)
    19 --> |-B|23(#23 0 + 22*0.25=5.5)

    %% Узел #22 (B=1, cost=5, cap=12) -> C
    22 --> |+C|24(#24 8)
    22 --> |-C|25(#25 5)

    %% Узел #23 (B=0, cost=0, cap=22) -> C
    23 --> |+C|26(#26 3)
    23 --> |-C|27(#27 0)

    %% Узел #8 (D=0,E=1,A=1, cost=19, cap=7) -> B вес=10 не помещается => лист

    %% Узел #9 (D=0,E=1,A=0, cost=8, cap=18) -> B
    9 --> |+B|28(#28 13 + 8*0.25=15)
    9 --> |-B|29(#29 8 + 18*0.25=12.5)

    %% Узел #28 (B=1): C не помещается (cap=8, вес=12) => лист
    %% Узел #29 (B=0) -> C
    29 --> |+C|30(#30 11)
    29 --> |-C|31(#31 8)

    %% Узел #10 (D=1,E=1,A=1, cost=31, cap=3) -> B вес=10, C=12 => не помещаются => лист

    %% Узел #11 (D=1,E=1,A=0, cost=20, cap=14) -> B
    11 --> |+B|32(#32 25 + 4*0.25=26)
    11 --> |-B|33(#33 20 + 14*0.25=23.5)

    %% Узел #32 (B=1, cost=25, cap=4): C не помещается => лист
    %% Узел #33 (B=0, cost=20, cap=14) -> C
    33 --> |+C|34(#34 23 + 2*0.25=23.5)
    33 --> |-C|35(#35 20)

    %% Узлы #34 и #35 - листы

```


### Ответ
- Наибольшая стоимость предметов в рюкзаке 31.
- Набор предметов, обеспечивающих максимальную стоимость: A, D, E, общим весом 19.
- Свободное место в рюкзаке: 3.