# Задание №9
# Задача о максимальном потоке.

### Вариант 8:
#### Пропускная способность дуг сети:

|          Дуга          | sa | at | sb | ab | ac | bc | bt | ct |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 8  | 7  | 5  | 3  | 6  | 5  | 2  | 5  |

---

### 1. Построение исходной сети

Сеть с источником **s**, стоком **t** и заданными дугами имеет следующий вид:

~~~mermaid
graph LR
    s-->|8|a
    s-->|5|b
    a-->|7|t
    a-->|3|b
    a-->|6|c
    b-->|5|c
    b-->|2|t
    c-->|5|t
~~~

---

### 2. Построение начальной остаточной сети

Изначально поток во всех дугах равен нулю, поэтому для каждой дуги добавляем обратную дугу с той же пропускной способностью:

~~~mermaid
graph RL
    a-.->|8|s
    b-.->|5|s
    t-.->|7|a
    b-.->|3|a
    c-.->|6|a
    c-.->|5|b
    t-.->|2|b
    t-.->|5|c
~~~

---

### 3. Первый шаг — поиск увеличивающего пути

**Находим увеличивающий путь:**  
**t → a → s**

Этот обратный путь соответствует прямому пути **s → a → t**.

Определим резервные (доступные) пропускные способности, используя соответствующие прямые дуги:
- Для дуги **t → a** смотрим дугу **a → t**:  
  резервная способность = 7.
- Для дуги **a → s** смотрим дугу **s → a**:  
  резервная способность = 8.

min(7, 8) = **7**.

**Обновление потока и остаточной сети:**

- Для дуги **s → a**:  
  Новая остаточная емкость = 8 − 7 = **1**;  
  обратная дуга **a → s** получает поток 7 (емкость становится 7).
- Для дуги **a → t**:  
  Новая остаточная емкость = 7 − 7 = **0** (прямая дуга исчезает);  
  обратная дуга **t → a** получает поток 7 (емкость становится 7).

**Обновлённая остаточная сеть после первого шага:**

~~~mermaid
graph RL
    s-->|1|a
    a-.->|7|s
    s-->|5|b
    b-.->|5|s
    t-.->|7|a
    a-->|3|b
    b-.->|3|a
    a-->|6|c
    c-.->|6|a
    b-->|5|c
    c-.->|5|b
    b-->|2|t
    t-.->|2|b
    c-->|5|t
    t-.->|5|c
~~~

---

### 4. Второй шаг — поиск увеличивающего пути

В обновлённой остаточной сети выбираем следующий путь:

**Найдём увеличивающий путь:**  
**t → c → b → s**

Он соответствует прямому пути **s → b → c → t**.

Определим резервные способности:
- Для дуги **t → c**: смотрим дугу **c → t** с пропускной способностью **5**.
- Для дуги **c → b**: смотрим дугу **b → c** с пропускной способностью **5**.
- Для дуги **b → s**: смотрим дугу **s → b** с пропускной способностью **5**.

min(5, 5, 5) = **5**.

**Обновление потока:**

- Для дуги **s → b**:  
  Новая остаточная емкость = 5 − 5 = **0**;  
  обратная дуга **b → s** получает 5.
- Для дуги **b → c**:  
  Новая остаточная емкость = 5 − 5 = **0**;  
  обратная дуга **c → b** обновляется: 5 + 5 = **10**.
- Для дуги **c → t**:  
  Новая остаточная емкость = 5 − 5 = **0**;  
  обратная дуга **t → c** обновляется: 5 + 5 = **10**.

**Обновлённая остаточная сеть после второго шага:**

~~~mermaid

graph RL
    s-->|1|a
    a-.->|7|s
    b-.->|5|s
    t-.->|7|a
    a-->|3|b
    b-.->|3|a
    a-->|6|c
    c-.->|6|a
    c-.->|10|b
    b-->|2|t
    t-.->|2|b
    t-.->|10|c
~~~

---

### 5. Третий шаг — поиск увеличивающего пути

Находим ещё один увеличивающий путь:

**Найдём увеличивающий путь:**  
**t → b → a → s**

Этот путь соответствует прямому пути **s → a → b → t**.

Определим резервные способности, учитывая соответствие с прямыми дугами:
- Для дуги **t → b**: смотрим дугу **b → t** с пропускной способностью **2**.
- Для дуги **b → a**: смотрим дугу **a → b** с пропускной способностью **3**.
- Для дуги **a → s**: смотрим дугу **s → a**. Обратите внимание – по **s → a** осталось всего **1** (так как ранее из 8 было использовано 7).

min(2, 3, 1) = **1**.

**Обновление потока:**

- Для дуги **s → a**:  
  Новая остаточная емкость = 1 − 1 = **0**;  
  обратная дуга **a → s** обновляется: 7 + 1 = **8**.
- Для дуги **a → b**:  
  Новая остаточная емкость = 3 − 1 = **2**;  
  обратная дуга **b → a** обновляется: 3 + 1 = **4**.
- Для дуги **b → t**:  
  Новая остаточная емкость = 2 − 1 = **1**;  
  обратная дуга **t → b** обновляется: 2 + 1 = **3**.

**Обновлённая остаточная сеть после третьего шага:**

~~~mermaid

graph RL
    a-.->|8|s
    b-.->|5|s
    t-.->|7|a
    a-->|2|b
    b-.->|4|a
    a-->|6|c
    c-.->|6|a
    c-.->|10|b
    b-->|1|t
    t-.->|3|b
    t-.->|10|c
~~~

Теперь из источника **s** не выходит ни одна дуга с положительной остаточной емкостью, поэтому увеличивающих путей больше нет.

---

### 6. Определение локальных потоков в исходной сети

Суммируем потоки, реализованные по каждой дуге:

- **s → a:**  
  Поток = 7 (из первого шага) + 1 (из третьего шага) = **8**  
  (максимум, т.к. емкость = 8).
- **a → t:**  
  Поток = **7** (из первого шага).
- **s → b:**  
  Поток = **5** (из второго шага).
- **a → b:**  
  Поток = **1** (из третьего шага).
- **a → c:**  
  Поток = **0** (не использовалась).
- **b → c:**  
  Поток = **5** (из второго шага).
- **b → t:**  
  Поток = **1** (из третьего шага).
- **c → t:**  
  Поток = **5** (из второго шага).

Суммарный поток, исходящий из **s**:  
8 (s→a) + 5 (s→b) = **13**.

Схематичное представление локальных потоков в сети:

~~~mermaid

graph LR
    s-->|"(8, 8)"|a
    s-->|"(5, 5)"|b
    a-->|"(7, 7)"|t
    a-->|"(1, 3)"|b
    a-->|"(0, 6)"|c
    b-->|"(5, 5)"|c
    b-->|"(1, 2)"|t
    c-->|"(5, 5)"|t
~~~

---

### 7. Проверка максимального потока через разрезы

Для сети с 5 вершинами возможно 2^(5–2)=8 разрезов. Рассмотрим несколько вариантов:

| № | V<sub>1</sub>        | V<sub>2</sub>      | Пропускная способность разреза              |
|---|----------------------|---------------------|---------------------------------------------|
| 1 | {s}                  | {a, b, c, t}        | s→a (8) + s→b (5) = **13**                   |
| 2 | {s, a}               | {b, c, t}           | s→b (5) + a→t (7) + a→b (3) + a→c (6) = 21    |
| 3 | {s, b}               | {a, c, t}           | s→a (8) + b→c (5) + b→t (2) = 15             |
| 4 | {s, c}               | {a, b, t}           | s→a (8) + s→b (5) + c→t (5) = 18             |
| 5 | {s, a, b}            | {c, t}              | a→c (6) + b→c (5) + a→t (7) + b→t (2) = 20    |
| 6 | {s, a, c}            | {b, t}              | s→b (5) + a→b (3) + a→t (7) + c→t (5) = 20    |
| 7 | {s, b, c}            | {a, t}              | s→a (8) + b→t (2) + c→t (5) = 15             |
| 8 | {s, a, b, c}         | {t}                 | a→t (7) + b→t (2) + c→t (5) = 14             |

Минимальная пропускная способность разреза равна **13** (разрез №1), что совпадает с найденным максимальным потоком.

---

### Ответ:

Максимальный поток в сети равен **13**, и он реализуется следующими локальными потоками:

~~~mermaid
graph LR
    s-->|"(8, 8)"|a
    s-->|"(5, 5)"|b
    a-->|"(7, 7)"|t
    a-->|"(1, 3)"|b
    a-->|"(0, 6)"|c
    b-->|"(5, 5)"|c
    b-->|"(1, 2)"|t
    c-->|"(5, 5)"|t
~~~
