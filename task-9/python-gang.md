# Задание №9
# Задача о максимальном потоке.

### Вариант 4:
#### Пропускная способность дуг сети:

|          Дуги          | sc | sa | ct | ca | cb | ab | at | bt |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 11 | 8  | 5  | 5  | 3  | 3  | 6  | 9  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг.

```mermaid
graph LR
    s-->|11|c
    s-->|8|a
    a-->|3|b
    a-->|6|t
    b-->|9|t
    c-->|5|t
    c-->|5|a
    c-->|3|b    
```

Построим остаточную сеть. Так как изначально поток в сети не задан, все дуги сети являются пустыми (локальный поток равен нулю), соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности.

```mermaid
graph RL
    c-.->|11|s
    a-.->|8|s
    b-.->|3|a
    t-.->|6|a
    t-.->|9|b
    t-.->|5|c
    a-.->|5|c
    b-.->|3|c    
```

### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> a -> s. Минимальный вес дуг на этом пути равен 6.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|11|s
    a-.->|2|s
    s-->|6|a
    b-.->|3|a
    a-->|6|t
    t-.->|9|b
    t-.->|5|c
    a-.->|5|c
    b-.->|3|c    
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> b -> a -> s. Минимальный вес дуг на этом пути равен 2.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|11|s
    s-->|8|a
    b-.->|1|a
    a-->|2|b
    a-->|6|t
    t-.->|7|b
    b-->|2|t
    t-.->|5|c
    a-.->|5|c
    b-.->|3|c    
```

### 4. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> c -> s. Минимальный вес дуг на этом пути равен 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|6|s
    s-->|5|c
    s-->|8|a
    b-.->|1|a
    a-->|2|b
    a-->|6|t
    t-.->|7|b
    b-->|2|t
    c-->|5|t
    a-.->|5|c
    b-.->|3|c    
```

### 5. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> b -> a -> c -> s. Минимальный вес дуг на этом пути равен 1.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|5|s
    s-->|6|c
    s-->|8|a
    a-->|3|b
    a-->|6|t
    t-.->|6|b
    b-->|3|t
    c-->|5|t
    a-.->|4|c
    c-->|1|a
    b-.->|3|c    
```

### 6. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> b -> c -> s. Минимальный вес дуг на этом пути равен 3.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    c-.->|2|s
    s-->|9|c
    s-->|8|a
    a-->|3|b
    a-->|6|t
    t-.->|3|b
    b-->|6|t
    c-->|5|t
    a-.->|4|c
    c-->|1|a
    c-->|3|b    
```

Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 

```mermaid
graph LR
    s-->|"(8, 8)"|a
    s-->|"(9, 11)"|c
    c-->|"(1, 5)"|a
    c-->|"(3, 3)"|b
    c-->|"(5, 5)"|t
    a-->|"(3, 3)"|b
    a-->|"(6, 6)"|t
    b-->|"(6, 9)"|t
```

### 7. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 17 является максимальным для данной сети. (проверка: сумма значений на ребрах из источника s = 17 и сумма значений на ребрах в сток t также равна 17).

### 8. Проверим значение максимального потока перебором всех разрезов сети.

Для сети из 5 вершин нужно найти 2<sup>5 - 2</sup> = 2<sup>3</sup> = 8 разрезов. 

| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, t    |           8 + 11 = 19           |
|   | **s + одна вершина из a, b, c** |               |                                |
| 2 | s, a                            | b, c, t       |         11 + 6 + 3 = 20         |
| 3 | s, b                            | a, c, t       |         11 + 8 + 9 = 28         |
| 4 | s, c                            | a, b, t       |         8 + 5 + 5 + 3 = 21         |
|   | **s + пара вершин из a, b, c**  |               |                                |
| 5 | s, a, b                         | c, t          |         11 + 6 + 9 = 26         |
| 6 | s, a, c                         | b, t          |         **6 + 3 + 3 + 5 = 17**         |
| 7 | s, b, c                         | a, t          |         8 + 5 + 5 + 9 = 27         |
|   | **s + три вершины из a, b, c**  |               |                                |
| 8 | s, a, b, c                      | t             |           5 + 6 + 9 = 20           |

Минимальная пропускная способность разреза равна 17 ( {s, a, c} / {b,t} ), что совпадает с найденной величиной максимального потока в сети.

### Ответ:
Максимальный поток в сети равен 17, он реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|"(8, 8)"|a
    s-->|"(9, 11)"|c
    c-->|"(1, 5)"|a
    c-->|"(3, 3)"|b
    c-->|"(5, 5)"|t
    a-->|"(3, 3)"|b
    a-->|"(6, 6)"|t
    b-->|"(6, 9)"|t
```