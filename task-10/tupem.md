### Вариант 1:
#### Пропускная способность дуг сети p(e) и стоимость транспортировки единицы потока c(e):


| Дуги                      | sa  | sb  | ad  | ab  | ac  | bc  | bd  | cd  | dt  |
| :------------------------ | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: | :-: |
| Пропускная способность    |  9  |  9  |  5  |  5  |  4  |  7  |  4  |  9  | 16  |
| Стоимость транспортировки |  1  |  2  |  7  |  1  |  1  |  1  |  5  |  3  |  1  |


#### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|9|a
    s-->|9|b
    a-->|5|d
    a-->|5|b
    a-->|4|c
    b-->|7|c
    b-->|4|d
    c-->|9|d
    d-->|16|t
```
Укажем начальный поток величиной 4 **s $\rightarrow$ a $\rightarrow$ b $\rightarrow$ d $\rightarrow$ t**. Построим соответствующую остаточную сеть.

```mermaid
graph RL
    s-->|4|a
    a-.->|5|s
    b-.->|9|s
    d-.->|5|a
    a-->|4|b
    b-.->|1|a
    c-.->|4|a
    c-.->|7|b
    b-->|4|d
    d-.->|9|c
    d-->|4|t
    t-.->|12|d
```

#### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь **t $\rightarrow$ d $\rightarrow$ c $\rightarrow$ b $\rightarrow$ s**. Минимальный вес дуг на этом пути равен 7.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    s-->|4|a
    a-.->|5|s
    b-.->|2|s
    s-->|7|b
    d-.->|5|a
    a-->|4|b
    b-.->|1|a
    c-.->|4|a
    b-->|7|c
    b-->|4|d
    d-.->|2|c
    c-->|7|d
    d-->|11|t
    t-.->|5|d
```

#### 3. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь **t $\rightarrow$ d $\rightarrow$ a $\rightarrow$ s**. Минимальный вес дуг на этом пути равен 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|9|a
    b-.->|2|s
    s-->|7|b
    a-->|5|d
    a-->|4|b
    b-.->|1|a
    c-.->|4|a
    b-->|7|c
    b-->|4|d
    d-.->|2|c
    c-->|7|d
    d-->|16|t
```

#### 4. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 16 является максимальным для данной сети.

```mermaid
graph LR
    s-->|9,9|a
    s-->|7,9|b
    a-->|5,5|d
    a-->|4,5|b
    a-->|0,4|c
    b-->|7,7|c
    b-->|4,4|d
    c-->|7,9|d
    d-->|16,16|t
```

#### 5. Рассчитаем стоимость полученного максимального потока.

| Дуги                                      | sa | sb | ad| ab| ac | bc| bd | cd | dt | Итого  |
|:------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)               |  9 |  9 |  5|  5|  4 |  7|  4 |  9 | 16 |   |
| Локальный поток f(e)                      |  9 |  7 |  5|  4|  0 |  7|  4 |  7 | 16 |   |
| Стоимость транспортировки единицы потока c(e) |  1 |  2 |  7|  1 |  1|  1 |  5 |  3 | 1 |   |
| Суммарная стоимость f(e)*c(e)             |  9 | 14 | 35|  4|  0 |  7| 20 | 21 | 16 |  *126*|

Стоимость полученного потока составляет 126 условных единиц. 

#### 6. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s-->|-1|a
    b-.->|2|s
    s-->|-2|b
    a-->|-7|d
    a-->|-1|b
    b-.->|1|a
    c-.->|1|a
    b-->|-1|c
    b-->|-5|d
    d-.->|3|c
    c-->|-3|d
    d-->|-1|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости **a $\rightarrow$ d $\rightarrow$ c $\rightarrow$ a** ($-7 + 3 + 1 = -3$). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|9|a
    b-.->|2|s
    s-->|7|b
    a-->|5|d
    a-->|4|b
    b-.->|1|a
    c-.->|4|a
    b-->|7|c
    b-->|4|d
    d-.->|2|c
    c-->|7|d
    d-->|16|t
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребер c $\rightarrow$ d и a $\rightarrow$ c.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|9|a
    b-.->|2|s
    s-->|7|b
    a-->|3|d
    d-.->|2|a
    a-->|4|b
    b-.->|1|a
    c-.->|2|a
    a-->|2|c
    b-->|7|c
    b-->|4|d
    c-->|9|d
    d-->|16|t
```

#### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-1|a
    b-.->|2|s
    s-->|-2|b
    a-->|-7|d
    d-.->|7|a
    a-->|-1|b
    b-.->|1|a
    c-.->|1|a
    a-->|1|c
    b-->|-1|c
    b-->|-5|d
    c-->|-3|d
    d-->|-1|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости **b $\rightarrow$ c $\rightarrow$ a $\rightarrow$ b**  ($- 1 + 1 - 1 = -1$). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph LR
    s-->|9|a
    b-.->|2|s
    s-->|7|b
    a-->|3|d
    d-.->|2|a
    a-->|4|b
    b-.->|1|a
    c-.->|2|a
    a-->|2|c
    b-->|7|c
    b-->|4|d
    c-->|9|d
    d-->|16|t
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра a $\rightarrow$ c.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|9|a
    b-.->|2|s
    s-->|7|b
    a-->|3|d
    d-.->|2|a
    a-->|2|b
    b-.->|3|a
    a-->|4|c
    b-->|5|c
    c-.->|2|b
    b-->|4|d
    c-->|9|d
    d-->|16|t
```

#### 8. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-1|a
    b-.->|2|s
    s-->|-2|b
    a-->|-7|d
    d-.->|7|a
    a-->|-1|b
    b-.->|1|a
    a-->|1|c
    b-->|-1|c
    c-.->|1|b
    b-->|-5|d
    c-->|-3|d
    d-->|-1|t
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

#### 9. Рассчитаем стоимость полученного максимального потока.

| Дуги                                      | sa | sb | ad| ab| ac | bc| bd | cd | dt | Итого  |
|:------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)               |  9 |  9 |  5|  5|  4 |  7|  4 |  9 | 16 |   |
| Локальный поток f(e)                      |  9 |  7 |  3|  2|  4 |  5|  4 |  9 | 16 |   |
| Стоимость транспортировки единицы потока c(e)|1|  2 |  7|  1|  1 |  1|  5 |  3 | 1  |   |
| Суммарная стоимость f(e)*c(e)             |  9 | 14 | 21|  2|  4 |  5| 20 | 27 | 16 |*118*|

Стоимость полученного потока составляет 118. 

#### Ответ:
Максимальный поток в сети равен 16, минимальная стоимость потока 118, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|9,9|a
    s-->|7,9|b
    a-->|3,5|d
    a-->|2,5|b
    a-->|4,4|c
    b-->|5,7|c
    b-->|4,4|d
    c-->|9,9|d
    d-->|16,16|t
```
