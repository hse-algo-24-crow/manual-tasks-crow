# Задание №10. Задача о максимальном потоке минимальной стоимости.
## Вариант 6

#### Пропускная способность дуг сети p(e) и стоимость транспортировки  единицы потока c(e):


| Дуги                      | sa | sb | ac | ab | bc | cd | de | ce | be | et |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 9  | 9  | 8  | 4  | 7  | 7  | 6  | 6  | 13 | 13 |
| Стоимость транспортировки | 2  | 2  | 3  | 2  | 2  | 3  | 3  | 6  | 8  | 2  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|9|a
    s-->|9|b
    a-->|8|c
    a-->|4|b
    b-->|7|c
    c-->|7|d
    d-->|6|e
    c-->|6|e
    b-->|13|e
    e-->|13|t
```

Укажем начальный поток величиной 6 **s -> a -> c -> d -> e -> t**. Построим соответствующую остаточную сеть.

```mermaid
graph RL
    t-.->|7|e-.->|13|b-.->|9|s
    e-.->|6|c-.->|7|b-.->|4|a
    d-.->|1|c-.->|2|a-.->|3|s
    s-->|6|a-->|6|c-->|6|d-->|6|e-->|6|t
```


### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> e -> b -> s. Минимальный вес дуг на этом пути равен 7.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph RL
    e-.->|6|b-.->|2|s
    e-.->|6|c-.->|7|b-.->|4|a
    d-.->|1|c-.->|2|a-.->|3|s
    s-->|6|a-->|6|c-->|6|d-->|6|e-->|13|t
    s-->|7|b-->|7|e
```

### 3. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 13 является максимальным для данной сети.

```mermaid
graph LR
    s-->|6,9|a
    s-->|7,9|b
    a-->|6,8|c
    a-->|0,4|b
    b-->|0,7|c
    c-->|6,7|d
    d-->|6,6|e
    c-->|0,6|e
    b-->|7,13|e
    e-->|13,13|t
```

### 4. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa | sb | ac | ab | bc | cd | de | ce | be | et | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 9  | 9  | 8  | 4  | 7  | 7  | 6  | 6  | 13 | 13 |        |
| Локальный поток f(e)                          | 6  | 7  | 6  | 0  | 0  | 6  | 6  | 0  | 7  | 13 |        |
| Стоимость транспортировки единицы потока c(e) | 2  | 2  | 3  | 2  | 2  | 3  | 3  | 6  | 8  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 12 | 14 | 18 | 0  | 0  | 18 | 18 | 0  | 56 | 26 | **162** |

Стоимость полученного потока составляет 162. 

### 5. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid

graph RL
    e-.->|8|b-.->|2|s
    e-.->|6|c-.->|2|b-.->|2|a
    d-.->|3|c-.->|3|a-.->|2|s
    s-->|-2|a-->|-3|c-->|-3|d-->|-3|e-->|-2|t
    s-->|-2|b-->|-8|e
```
В остаточной сети найден ориентированный цикл отрицательной стоимости s -> a -> c -> d -> e -> b -> s (- 2 - 3 -3 -3 + 8 + 2 = -1). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  

```mermaid
graph RL
    e-.->|6|b-.->|2|s
    e-.->|6|c-.->|7|b-.->|4|a
    d-.->|1|c-.->|2|a-.->|3|s
    s-->|6|a-->|6|c-->|6|d-->|6|e-->|13|t
    s-->|7|b-->|7|e
```

Минимальный вес ребра в цикле 2 - это неиспользованный резерв ребра b -> s.

Удалим найденный цикл - уменьшим на 2 вес всех ребер, входящих в цикл.

```mermaid
graph RL
    e-.->|4|b
    e-.->|6|c-.->|7|b-.->|4|a
    d-.->|3|c-.->|4|a-.->|5|s
    e-.->|2|d
    s-->|4|a-->|4|c-->|4|d-->|4|e-->|13|t
    s-->|9|b-->|9|e
```

### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid

graph RL
    e-.->|8|b
    e-.->|6|c-.->|2|b-.->|2|a
    d-.->|3|c-.->|3|a-.->|2|s
    e-.->|3|d
    s-->|-2|a-->|-3|c-->|-3|d-->|-3|e-->|-2|t
    s-->|-2|b-->|-8|e
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 7. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa | sb | ac | ab | bc | cd | de | ce | be | et | Итого  |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:------:|
| Пропускная способность p(e)                   | 9  | 9  | 8  | 4  | 7  | 7  | 6  | 6  | 13 | 13 |        |
| Локальный поток f(e)                          | 4  | 9  | 4  | 0  | 0  | 4  | 4  | 0  | 9  | 13 |        |
| Стоимость транспортировки единицы потока c(e) | 2  | 2  | 3  | 2  | 2  | 3  | 3  | 6  | 8  | 2  |        |
| Суммарная стоимость f(e)*c(e)                 | 8  | 18 | 12 | 0  | 0  | 12 | 12 | 0  | 72 | 26 | **160** |


Стоимость полученного потока составляет 160. 

### Ответ:
Максимальный поток в сети равен 13, минимальная стоимость потока 160, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|4,9|a
    s-->|9,9|b
    a-->|4,8|c
    a-->|0,4|b
    b-->|0,7|c
    c-->|4,7|d
    d-->|4,6|e
    c-->|0,6|e
    b-->|9,13|e
    e-->|13,13|t
```
