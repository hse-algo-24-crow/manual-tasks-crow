
# Задание №10
### Постановка задачи

1. Дана сеть (взвешенный ориентированный граф) с источником \(s\) и стоком \(t\).  
2. Для каждой дуги определена пропускная способность \(p(e)\) и стоимость транспортировки \(c(e)\).  
3. Необходимо найти для указанной сети **максимальный поток** **минимальной стоимости**.


### Вариант 3

#### Пропускная способность дуг сети \(p(e)\) и стоимость транспортировки единицы потока \(c(e)\):

| Дуги | sa | sc | ab | ad | ac | cd | bd | dt |
|:----:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| **Пропускная способность** | 9 | 9 | 5 | 5 | 5 | 11 | 5 | 11 |
| **Стоимость транспортировки** | 3 | 3 | 3 | 6 | 3 | 8 | 3 | 3  |

---

### 1. Построим сеть с источником \(s\), стоком \(t\) и указанными пропускными способностями дуг для поиска максимального потока

```mermaid
graph LR
    s -- 9 --> a
    s -- 9 --> c
    a -- 5 --> b
    a -- 5 --> d
    a -- 5 --> c
    c -- 11 --> d
    b -- 5 --> d
    d -- 11 --> t
```


Укажем начальный поток величиной s -> a -> b -> d -> t. И построим соответствующую остаточную сеть.

```mermaid
graph LR
    s -- "5" --> a
    s -- "9" --> c
    a -- "5" --> d
    a -- "5" --> c
    c -- "11" --> d
    a -- "4" --> s
    b -- "5" --> a
    d -- "5" --> b
    t -- "11" --> d
```

### 2. Проведем поиск увеличивающего пути в остаточной сети

В остаточной сети находим увеличивающий путь s -> a -> d -> t. Минимальный вес дуг на этом пути равен 5.
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s -- "5" --> c
    a -- "5" --> c
    c -- "5" --> d
    d -- "5" --> b
    t -- "6" --> d
    b -- "5" --> a
    d -- "5" --> a
    a -- "5" --> s
    t -- "11" --> d
```

### 3. Продолжаем поиск увеличивающего пути в остаточной сети

Найден новый увеличивающий путь s -> c -> d -> t
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph LR
    s -- "9" --> c
    a -- "5" --> c
    c -- "1" --> s
    d -- "1" --> c
    d -- "5" --> b
    t -- "17" --> d
    b -- "5" --> a
    d -- "5" --> a
    a -- "5" --> s
```

### 4. Продолжаем поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 11 является максимальным для данной сети.

### 5. Рассчитаем стоимость полученного максимального потока

|          Дуги                                | sa | sc | ab | ad | ac | cd | bd | dt |  Итого  |
|:--------------------------------------------:|:--:|:--:|----|:--:|:--:|:--:|:--:|:--:|:-------:|
| **Пропускная способность**                   | 9  | 9  | 5  | 5  | 5  | 11 | 5  | 11 |         |
| **Локальный поток** f(e)                     | 4  | 7  | 5  | 2  | 0  | 7  | 5  | 11 |         |
| **Стоимость транспортировки** c(e)           | 3  | 3  | 3  | 6  | 3  | 8  | 3  | 3  |         |
| **Суммарная стоимость** f(e)*c(e)            | 12 | 21 | 15 | 12 | 0  | 56 | 15 | 33 | **164** |

Стоимость полученного потока составляет 164.

### 6. Попробуем уменьшить стоимость потока для чего построим остаточную цепь.

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph RL
    d-.->|8|c
    d-.->|3|b
    d-.->|6|a
    b-.->|3|a
    c-.->|3|a
    a-.->|3|s
    s-->|-3|a
    a-->|-6|d
    s-->|-3|c
    c-->|-8|d
    d-->|-3|t
```
В остаточной сети найден ориентированный цикл отрицательной стоимости s → c → d → a → s (-3 → -8 → +6 → +3 = -2). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.

Минимальный вес ребра в цикле 3 - это неиспользованный резерв ребра a → d.  

Удалим найденный цикл - уменьшим на 3 вес всех ребер, входящих в цикл.

```mermaid
graph RL
    d-.->|5|c
    d-.->|5|b
    a-->|5|d
    b-.->|5|a
    c-.->|5|a
    a-.->|4|s
    s-->|5|a
    a-->|5|d
    s-->|6|c
    c-.->|3|s
    c-->|6|d
    d-->|11|t
```

### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

Снова скорректируем остаточную сеть и проверим наличие новых циклов отрицательной стоимости.

```mermaid
graph RL
    d-.->|8|c
    d-.->|3|b
    a-->|-6|d
    b-.->|3|a
    c-.->|3|a
    a-.->|3|s
    s-->|-3|a
    s-->|-3|c
    c-.->|3|s
    c-->|-8|d
    d-->|-3|t
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

### 8. Рассчитаем стоимость полученного максимального потока.

|          Дуги                                | sa | sc | ab | ad | ac | cd | bd | dt |  Итого  |
|:--------------------------------------------:|:--:|:--:|----|:--:|:--:|:--:|:--:|:--:|:-------:|
| **Пропускная способность**                   | 9  | 9  | 5  | 5  | 5  | 11 | 5  | 11 |         |
| **Локальный поток** f(e)                     | 5  | 3  | 5  | 2  | 3  | 3  | 5  | 11 |         |
| **Стоимость транспортировки** c(e)           | 3  | 3  | 3  | 6  | 3  | 8  | 3  | 3  |         |
| **Суммарная стоимость** f(e)*c(e)            | 15 | 9  | 15 | 12 | 9  | 24 | 15 | 33 | **132** |

Стоимость полученного потока составляет 132. 

### **Ответ:**  
Максимальный поток в сети равен **11**, минимальная стоимость потока **132**, она реализуется следующими локальными потоками:

```mermaid
graph LR
    s-->|5,9|a
    s-->|3,9|c
    a-->|5,5|b
    a-->|2,5|d
    a-->|3,5|c
    c-->|3,11|d
    b-->|5,5|d
    d-->|11,11|t
```