# Задание 10. Вариант 2 #
## Постановка задачи ##
#### Пропускная способность дуг сети p(e) и стоимость транспортировки  единицы потока c(e):

| Дуги                          | sa | sb | bc | ab | ac | ad | cd | dt | at |
|:------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность p(e)   | 5  | 11 | 5  | 2  | 4  | 11 | 9  | 13 | 5  |
| Стоимость транспортировки c(e)| 2  | 3  | 2  | 3  | 4  | 6  | 2  | 1  | 8  |

#### 1. Построим сеть с источником s, стоком t и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|5|a
    s-->|11|b
    b-->|5|c
    a-->|2|b
    a-->|4|c
    a-->|11|d
    c-->|9|d
    d-->|13|t
    a-->|5|t
```
Построим остаточную цепь
```mermaid
graph LR
    a-.->|5|s
    b-.->|11|s
    c-.->|5|b
    b-.->|2|a
    c-.->|4|a
    d-.->|11|a
    d-.->|9|c
    t-.->|13|d
    t-.->|5|a
```
Найдём начальный поток величиной 5 t -> a -> s

```mermaid
graph LR
    s-->|5|a
    b-.->|11|s
    c-.->|5|b
    b-.->|2|a
    c-.->|4|a
    d-.->|11|a
    d-.->|9|c
    t-.->|13|d
    a-->|5|t
```
#### 2. Проведем поиск увеличивающего пути в остаточной сети.
В остаточной сети найден увеличивающий путь t -> d -> c -> b -> s. Минимальный вес дуги на данном пути 5.

Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.

```mermaid
graph LR
    s-->|5|a
    b-.->|6|s
    s-->|5|b
    b-->|5|c
    b-.->|2|a
    c-.->|4|a
    d-.->|11|a
    d-.->|4|c
    c-->|5|d
    t-.->|8|d
    d-->|5|t
    a-->|5|t
```
#### 3. Продолжим поиск увеличивающего пути в остаточной сети.

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 10 является максимальным для данной сети.

```mermaid
graph LR
    s-->|5, 5|a
    s-->|5, 11|b
    b-->|5, 5|c
    a-->|0, 2|b
    a-->|0, 4|c
    a-->|0, 11|d
    c-->|5, 9|d
    d-->|5, 13|t
    a-->|5, 5|t
```

#### 4. Рассчитаем стоимость полученного максимального потока.

| Дуги                          | sa | sb | bc | ab | ac | ad | cd | dt | at |Итого|
|:------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:---:|
| Пропускная способность p(e)   | 5  | 11 | 5  | 2  | 4  | 11 | 9  | 13 | 5  |:---:|
| Стоимость транспортировки c(e)| 2  | 3  | 2  | 3  | 4  | 6  | 2  | 1  | 8  |:---:|
| Локальный поток f(e)          | 5  | 5  | 5  | 0  | 0  | 0  | 5  | 5  | 5  |:---:|
| Суммарная стоимость c(e)*f(e) | 10 | 15 | 10 | 0  | 0  | 0  | 10 | 5  | 40 | 90  |

Стоимость полученного потока составляет 90.

#### 5. Попробуем уменьшить стоимость потока, для этого построим остаточную цепь.

Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    b-.->|+3|s
    s-->|-3|b
    b-->|-2|c
    b-.->|+3|a
    c-.->|+4|a
    d-.->|+6|a
    d-.->|+2|c
    c-->|-2|d
    t-.->|+1|d
    d-->|-1|t
    a-->|-8|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости t -> d -> c -> a -> t (+ 1 + 2 + 4 - 8 = -1).

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

```mermaid
graph LR
    s-->|5|a
    b-.->|6|s
    s-->|5|b
    b-->|5|c
    b-.->|2|a
    c-.->|4|a
    d-.->|11|a
    d-.->|4|c
    c-->|5|d
    t-.->|8|d
    d-->|5|t
    a-->|5|t
```

Минимальный вес ребра в цикле 4.

Удалим найденный цикл - уменьшим на 4 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|5|a
    b-.->|6|s
    s-->|5|b
    b-->|5|c
    b-.->|2|a
    a-->|4|c
    d-.->|11|a
    c-->|9|d
    t-.->|4|d
    d-->|9|t
    a-->|1|t
    t-.->|4|a
```

#### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    b-.->|+3|s
    s-->|-3|b
    b-->|-2|c
    b-.->|+3|a
    a-->|-4|c
    d-.->|+6|a
    c-->|-2|d
    t-.->|+1|d
    d-->|-1|t
    a-->|-8|t
    t-.->|+8|a
```

В остаточной сети найден ориентированный цикл отрицательной стоимости t -> d -> a -> t (+ 1 + 6 - 8 = -1).

Найдем минимальный вес ребра в указанном цикле, изображенном в остаточной сети с указанием величины потока.

```mermaid
graph LR
    s-->|5|a
    b-.->|6|s
    s-->|5|b
    b-->|5|c
    b-.->|2|a
    a-->|4|c
    d-.->|11|a
    c-->|9|d
    t-.->|4|d
    d-->|9|t
    a-->|1|t
    t-.->|4|a
```

Минимальный вес ребра в цикле 1.

Удалим найденный цикл - уменьшим на 1 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    s-->|5|a
    b-.->|6|s
    s-->|5|b
    b-->|5|c
    b-.->|2|a
    a-->|4|c
    d-.->|10|a
    a-->|1|d
    c-->|9|d
    t-.->|3|d
    d-->|10|t
    t-.->|5|a
```
#### 7. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.

Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.

```mermaid
graph LR
    s-->|-2|a
    b-.->|+3|s
    s-->|-3|b
    b-->|-2|c
    b-.->|+3|a
    a-->|-4|c
    a-.->|-6|d
    c-->|-2|d
    t-.->|+1|d
    d-->|-1|t
    t-.->|+8|a
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.

#### 8. Рассчитаем стоимость полученного максимального потока.

| Дуги                          | sa | sb | bc | ab | ac | ad | cd | dt | at |Итого|
|:------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:---:|
| Пропускная способность p(e)   | 5  | 11 | 5  | 2  | 4  | 11 | 9  | 13 | 5  |     |
| Стоимость транспортировки c(e)| 2  | 3  | 2  | 3  | 4  | 6  | 2  | 1  | 8  |     |
| Локальный поток f(e)          | 5  | 5  | 5  | 0  | 4  | 1  | 9  | 10 | 0  |     |
| Суммарная стоимость c(e)*f(e) | 10 | 15 | 10 | 0  | 16 | 6  | 18 | 10 | 0  | 85  |

Стоимость полученного потока составляет 85.

### Ответ

Максимальный поток в сети равен 10, минимальная стоимость потока 85, она реализуется следующим локальными потоками:

```mermaid
graph LR
    s-->|5, 5|a
    s-->|5, 11|b
    b-->|5, 5|c
    a-->|0, 2|b
    a-->|4, 4|c
    a-->|1, 11|d
    c-->|9, 9|d
    d-->|10, 13|t
    a-->|0, 5|t
```