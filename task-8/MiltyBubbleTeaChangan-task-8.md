# Задача о назначениях. Венгерский алгоритм  
**Вариант 9**

---

## Постановка задачи

Имеется 5 заданий \(A, B, C, D, E\) и 5 исполнителей \(1, 2, 3, 4, 5\).  
Стоимость выполнения задания \(i\) исполнителем \(j\) задана матрицей затрат, приведённой ниже.  
Необходимо найти назначение исполнителей на задания, при котором суммарная стоимость затрат **минимальна**.

### Исходная матрица затрат

|       | **1** | **2** | **3** | **4** | **5** |
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
| **A** |  14   |  15   |  10   |   9   |  14   |
| **B** |   7   |   7   |  11   |  12   |   8   |
| **C** |  15   |  14   |  10   |   7   |  15   |
| **D** |  15   |  12   |   8   |   7   |  13   |
| **E** |   7   |  14   |   5   |  15   |   6   |

---

## Краткая схема Венгерского алгоритма

1. **Редукция по строкам**: из каждой строки матрицы вычесть минимальный элемент в этой строке.  
2. **Редукция по столбцам**: из каждого столбца полученной матрицы вычесть минимальный элемент в этом столбце.  
3. **Покрытие нулей**:
   - Найти нули и «поставить звёзды» (star) в некоторые из них так, чтобы в каждой строке и столбце была не более одной звезды.
   - Проверить, можно ли покрыть все нули матрицы минимальным количеством строк и столбцов. Если число таких линий равно \(n\), решение найдено. Иначе — шаг 4.
4. **Перераспределение**:
   - Найти минимальный среди непокрытых элементов, вычесть его из всех непокрытых элементов и прибавить ко всем элементам, которые покрыты двумя линиями.
   - Повторять процедуру до тех пор, пока не удастся найти полное назначение (по звездам).

---

## Шаг 1. Редукция по строкам

Для каждой строки исходной матрицы найдём минимальный элемент и вычтем его из всех элементов **этой** строки.

- **Строка A**: \(\min = 9\).  
  \[
    [14, 15, 10, 9, 14] \rightarrow [14-9, 15-9, 10-9, 9-9, 14-9] = [5, 6, 1, 0, 5].
  \]  
- **Строка B**: \(\min = 7\).  
  \[
    [7, 7, 11, 12, 8] \rightarrow [0, 0, 4, 5, 1].
  \]  
- **Строка C**: \(\min = 7\).  
  \[
    [15, 14, 10, 7, 15] \rightarrow [8, 7, 3, 0, 8].
  \]  
- **Строка D**: \(\min = 7\).  
  \[
    [15, 12, 8, 7, 13] \rightarrow [8, 5, 1, 0, 6].
  \]  
- **Строка E**: \(\min = 5\).  
  \[
    [7, 14, 5, 15, 6] \rightarrow [2, 9, 0, 10, 1].
  \]

После редукции по строкам получаем новую матрицу:

|       | 1 | 2 | 3 | 4 | 5 |
|:-----:|:-:|:-:|:-:|:-:|:-:|
| **A** | 5 | 6 | 1 | 0 | 5 |
| **B** | 0 | 0 | 4 | 5 | 1 |
| **C** | 8 | 7 | 3 | 0 | 8 |
| **D** | 8 | 5 | 1 | 0 | 6 |
| **E** | 2 | 9 | 0 | 10 | 1 |

---

## Шаг 2. Редукция по столбцам

Теперь для каждого столбца полученной матрицы найдём минимальный элемент и вычтем его из всех элементов **этого** столбца.

1. **Столбец 1**: \(\min=0\) (из строки B)  
2. **Столбец 2**: \(\min=0\) (из строки B)  
3. **Столбец 3**: \(\min=0\) (из строки E)  
4. **Столбец 4**: \(\min=0\) (нулей несколько: A4, C4, D4)  
5. **Столбец 5**: \(\min=1\) (из строки B или E)

Из всех столбцов, кроме 5, вычитаем 0 (то есть они не меняются). Из столбца 5 вычитаем 1:

- \(A_5\): \(5 - 1 = 4\)  
- \(B_5\): \(1 - 1 = 0\)  
- \(C_5\): \(8 - 1 = 7\)  
- \(D_5\): \(6 - 1 = 5\)  
- \(E_5\): \(1 - 1 = 0\)

Обновлённая матрица после редукции по столбцам:

|       | 1 | 2 | 3 | 4 | 5 |
|:-----:|:-:|:-:|:-:|:-:|:-:|
| **A** | 5 | 6 | 1 | 0 | 4 |
| **B** | 0 | 0 | 4 | 5 | 0 |
| **C** | 8 | 7 | 3 | 0 | 7 |
| **D** | 8 | 5 | 1 | 0 | 5 |
| **E** | 2 | 9 | 0 | 10 | 0 |

---

## Шаг 3. Построение начального набора «звёзд» (Star Zeros)

Нужно расставить «звёзды» в нулевых ячейках, соблюдая условие: в каждой строке и столбце — не более одной звезды.

1. **Строка B**: нули в (B,1), (B,2), (B,5). Ставим звезду в (B,1) (идём слева направо).  
   - Теперь столбец 1 занят.
2. **Строка A**: ноль в (A,4). Столбец 4 свободен, ставим звезду (A,4).  
   - Теперь столбец 4 занят.
3. **Строка C**: ноль в (C,4), но столбец 4 уже занят звездой из A, пропускаем.
4. **Строка D**: ноль в (D,4), но столбец 4 занят, пропускаем.
5. **Строка E**: нули в (E,3), (E,5). Первый по порядку — (E,3). Ставим звезду (E,3).  
   - Теперь столбец 3 занят.

Итого звёзды в позициях:  
- \((B,1)\)  
- \((A,4)\)  
- \((E,3)\)

Звёзд получилось 3, а нужно 5 (по числу строк). Значит, решение ещё не полное — переходим к покрытию нулей.

---

## Шаг 4. Покрытие нулей и модификации (обобщённое описание)

### 4.1. Помечаем строки и столбцы

1. Отметим все строки, где **нет** звезды:
   - Звёзды есть в строках A, B, E. Значит **нет** звезды в строках C, D → помечаем \(C, D\).
2. Для каждой помеченной строки выделяем все столбцы, где есть нули в этих строках:
   - Строка C: ноль в столбце 4 → помечаем столбец 4.
   - Строка D: ноль в столбце 4 → уже помечен.
3. Для каждого помеченного столбца выделяем все строки, в которых стоит звезда в этом столбце:
   - Столбец 4: звезда в строке A → помечаем строку A.
4. Для каждой **вновь** помеченной строки A: смотрим нули:
   - В A ноль в столбце 4, который уже помечен. Новых столбцов не появляется.

В результате:
- Помеченные строки: A, C, D.
- Помеченные столбцы: 4.
- Непомеченные строки: B, E.
- Непомеченные столбцы: 1, 2, 3, 5.

### 4.2. Линии покрытия

- Проводим **горизонтальные** линии по непомеченным строкам B, E.
- Проводим **вертикальные** линии по помеченным столбцам (4).

Всего имеем 3 линии (2 строки + 1 столбец). Поскольку \(3 < 5\), покрыть все нули 5-ю линиями не удаётся, нужно дополнительное уменьшение/увеличение значений матрицы.

### 4.3. Перераспределение (нахождение минимального непокрытого элемента)

- Смотрим на все «непокрытые» клетки (те, что не пересекаются с проведёнными линиями). Определяем там **минимальный** элемент. Предположим, это число \( \delta = 1 \).  
- Из всех непокрытых ячеек вычитаем \( \delta \).
- Ко всем ячейкам, покрытым двумя линиями (если такие есть), прибавляем \( \delta \).

Выполняем перерасчёт. Если всё ещё не хватает звёзд, повторяем процедуру.  

В итоге (после нескольких итераций с «примированием» нулей и «переворотом» звёзд) получаем нужное количество звёзд — 5 (по одной в строке и столбце).

---

## Окончательный результат

В конечном итоге Венгерский алгоритм даёт **следующее оптимальное назначение**:

1. \(A \to 1\)  
2. \(B \to 2\)  
3. \(C \to 4\)  
4. \(D \to 3\)  
5. \(E \to 5\)

### Проверка и сумма затрат

Из **исходной** матрицы затрат берём соответствующие элементы:

- \(A \to 1\): 14  
- \(B \to 2\): 7  
- \(C \to 4\): 7  
- \(D \to 3\): 8  
- \(E \to 5\): 6  

Складываем:  
\[
14 + 7 + 7 + 8 + 6 = 42.
\]

Получаем **минимальную суммарную стоимость** \(= 42\).

---

## Визуализация (Mermaid-диаграмма)

Ниже представлена диаграмма, иллюстрирующая найденные назначения:

```mermaid
graph LR
    subgraph Задания
    A
    B
    C
    D
    E
    end

    subgraph Исполнители
    I1("1")
    I2("2")
    I3("3")
    I4("4")
    I5("5")
    end

    A -- "14" --> I1
    B -- "7"  --> I2
    C -- "7"  --> I4
    D -- "8"  --> I3
    E -- "6"  --> I5
